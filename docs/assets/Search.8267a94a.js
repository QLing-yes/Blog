import{d as B,v as l,i,j as s,x as m,t as f,y as N,q as S,s as I,_ as b,r as u,n as T,o as V,a as z,z as M,A as R,B as j,k as F,C as D,D as G,E as $,l as H,F as P,e as U,f as K,G as Y,H as Z,I as J,R as O}from"./index.ec1c96eb.js";import{L as Q}from"./autoLoad.4973cfac.js";import{g as W}from"./date.87d4c628.js";const X=n=>(S("data-v-e86ab7e6"),n=n(),I(),n),ee={class:"card"},te={key:0,class:"imgBox"},se=["src"],ae={class:"Box"},ne={class:"title serif"},oe={key:0,class:"date"},le=X(()=>s("span",{class:"icon"},"\uE638",-1)),ce={class:"content serif"},re=B({__name:"card",props:{img:null,head:null,date:null},setup(n){return(v,g)=>(l(),i("div",ee,[n.img?(l(),i("div",te,[s("img",{src:n.img,loading:"lazy",decoding:"async"},null,8,se)])):m("",!0),s("div",ae,[s("span",ne,[s("span",null,f(n.head),1),n.date?(l(),i("span",oe,[le,s("span",null,f(n.date),1)])):m("",!0)]),s("div",ce,[N(v.$slots,"default",{},void 0,!0)])])]))}});const ue=b(re,[["__scopeId","data-v-e86ab7e6"]]),w=n=>(S("data-v-aedef4e6"),n=n(),I(),n),ie={class:"SearchBox"},de={class:"query"},_e=w(()=>s("div",{class:"bar"},[s("span",null,"ctrl+k"),s("span",null,"enter"),s("span",null,"\u5173\u952E\u8BCD"),s("span",null,"\u6807\u7B7E")],-1)),fe={class:"line brief"},ve={class:"line tag"},pe=w(()=>s("span",{class:"icon"},"\uE652",-1)),he=B({__name:"Search",setup(n){const v=H(),g=P("isPC")?document.documentElement:document.body,C=u(),p=u(),c=u(""),h=u([]),y=u("");T(()=>{var t;U.value=!1,(t=p.value)==null||t.addEventListener("keydown",e=>{e.key=="Enter"&&(e.preventDefault(),_())}),document.addEventListener("keydown",k)}),V(()=>{g.scrollTo({left:0,top:window.screen.availHeight-100});const{query:t,field:e}=v.query;c.value=t,y.value=e,_()}),z(()=>{document.removeEventListener("keydown",k)});function k(t){var r;const{ctrlKey:e,key:a}=t;e&&a=="k"&&(t.preventDefault(),(r=p.value)==null||r.focus())}let E;const d=u(0);function _(){queueMicrotask(()=>{const t=x(c.value);let e=x(y.value);!t||(c.value=t,E=M(()=>{K({brief:!0,search:c.value,field:e,start:d.value}).then(a=>{const{err:r,res:o}=a;for(let q of o.Article)h.value.push(q);o!=null&&o.Article.length?d.value=o.Article[o.Article.length-1].ID:d.value=0})},E,800))})}function x(t){var e;return t?(e=t.substring(0,30).match(/[a-zA-Z]|[0-9]|[\u4e00-\u9fa5]|[.]/g))==null?void 0:e.toString().replace(/,/g,"").trim():""}function A(t){if(!t)return"";const{Y:e,M:a,D:r}=W(new Date(t));return`${e}-${a}-${r}`}function L(t){O.push({path:"/Article",query:{ID:t.ID}})}return(t,e)=>(l(),i("div",{class:"Search",ref_key:"ElSearch",ref:C},[s("div",ie,[s("div",de,[R(s("input",{type:"text",ref_key:"Elinput",ref:p,maxlength:"30",size:"30","onUpdate:modelValue":e[0]||(e[0]=a=>c.value=a),placeholder:"\u641C\u7D22: \u5173\u952E\u8BCD, \u6807\u7B7E"},null,512),[[j,c.value]]),s("span",{class:"submit",onClick:e[1]||(e[1]=a=>_())},"\uE8B9")]),_e]),F(G,{class:"list",name:"list",tag:"ul"},{default:D(()=>[(l(!0),i(Y,null,Z(h.value,(a,r)=>(l(),$(ue,{class:"card",onClick:o=>L(a),img:a.coverImg,head:a.title,date:A(a.time),key:a.ID},{default:D(()=>[s("span",fe,f(a.brief),1),s("span",ve,[pe,J(" "+f(a.tag),1)])]),_:2},1032,["onClick","img","head","date"]))),128))]),_:1}),h.value&&d.value?(l(),$(Q,{key:0,onLoad:e[2]||(e[2]=a=>_())})):m("",!0)],512))}});const ke=b(he,[["__scopeId","data-v-aedef4e6"]]);export{ke as default};
