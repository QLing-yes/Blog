import{d as S,v as c,i as d,j as t,x as m,t as f,y as V,q as I,s as w,_ as C,r as u,n as D,o as z,a as M,z as R,A as j,B as F,k as G,C as $,D as H,E as B,l as P,F as U,e as K,f as Y,G as Z,H as J,I as O,R as Q}from"./index.1ea3f93c.js";import{L as W}from"./autoLoad.1e2b4c01.js";import{g as X}from"./date.87d4c628.js";const ee=n=>(I("data-v-7916459c"),n=n(),w(),n),te={class:"card"},se={key:0,class:"imgBox"},ae=["src"],ne={class:"Box"},oe={class:"title serif"},ce={key:0,class:"date"},le=ee(()=>t("span",{class:"icon"},"\uE638",-1)),re={class:"content serif"},ue=S({__name:"card",props:{img:null,head:null,date:null},setup(n){return(p,g)=>(c(),d("div",te,[n.img?(c(),d("div",se,[t("img",{src:n.img,loading:"lazy",decoding:"async"},null,8,ae)])):m("",!0),t("div",ne,[t("span",oe,[t("span",null,f(n.head),1),n.date?(c(),d("span",ce,[le,t("span",null,f(n.date),1)])):m("",!0)]),t("div",re,[V(p.$slots,"default",{},void 0,!0)])])]))}});const ie=C(ue,[["__scopeId","data-v-7916459c"]]),b=n=>(I("data-v-60032c1c"),n=n(),w(),n),de={class:"SearchBox"},_e={class:"query"},ve=b(()=>t("div",{class:"bar"},[t("span",null,"ctrl+k"),t("span",null,"enter"),t("span",null,"\u5173\u952E\u8BCD"),t("span",null,"\u6807\u7B7E")],-1)),fe={class:"line brief"},pe={class:"line tag"},he=b(()=>t("span",{class:"icon"},"\uE652",-1)),me=S({__name:"Search",setup(n){const p=P(),g=U("isPC")?document.documentElement:document.body,A=u(),h=u(),l=u(""),_=u([]),y=u(""),i=u(0);D(()=>{K.value=!1}),z(()=>{D(()=>{var e;(e=h.value)==null||e.addEventListener("keydown",o=>{o.key=="Enter"&&(o.preventDefault(),v(!0))}),document.addEventListener("keydown",k)}),g.scrollTo({left:0,top:window.screen.availHeight-100});const{query:a,field:s}=p.query;l.value=a,y.value=s,v()}),M(()=>{document.removeEventListener("keydown",k)});function k(a){var o;const{ctrlKey:s,key:e}=a;s&&e=="k"&&(a.preventDefault(),(o=h.value)==null||o.focus())}let E;function v(a){a&&(i.value=0,_.value=[]),queueMicrotask(()=>{const s=x(l.value);let e=x(y.value);!s||(l.value=s,E=R(()=>{Y({brief:!0,search:l.value,field:e,start:i.value}).then(o=>{const{err:N,res:r}=o;for(let T of r.Article)_.value.push(T);r!=null&&r.Article.length?i.value=r.Article[r.Article.length-1].ID:i.value=0})},E,800))})}function x(a){var s;return a?(s=a.substring(0,30).match(/[a-zA-Z]|[0-9]|[\u4e00-\u9fa5]|[.]/g))==null?void 0:s.toString().replace(/,/g,"").trim():""}function L(a){if(!a)return"";const{Y:s,M:e,D:o}=X(new Date(a));return`${s}-${e}-${o}`}function q(a){Q.push({path:"/Article",query:{ID:a.ID}})}return(a,s)=>(c(),d("div",{class:"Search",ref_key:"ElSearch",ref:A},[t("div",de,[t("div",_e,[j(t("input",{type:"text",ref_key:"Elinput",ref:h,maxlength:"30",size:"30","onUpdate:modelValue":s[0]||(s[0]=e=>l.value=e),placeholder:"\u641C\u7D22: \u5173\u952E\u8BCD, \u6807\u7B7E"},null,512),[[F,l.value]]),t("span",{class:"submit",onClick:s[1]||(s[1]=e=>v(!0))},"\uE8B9")]),ve]),G(H,{class:"list",name:"list",tag:"ul"},{default:$(()=>[(c(!0),d(Z,null,J(_.value,(e,o)=>(c(),B(ie,{class:"card",onClick:N=>q(e),img:e.coverImg,head:e.title,date:L(e.time),key:e.ID},{default:$(()=>[t("span",fe,f(e.brief),1),t("span",pe,[he,O(" "+f(e.tag),1)])]),_:2},1032,["onClick","img","head","date"]))),128))]),_:1}),_.value&&i.value?(c(),B(W,{key:0,onLoad:s[2]||(s[2]=e=>v())})):m("",!0)],512))}});const Ee=C(me,[["__scopeId","data-v-60032c1c"]]);export{Ee as default};
